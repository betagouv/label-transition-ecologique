(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6656:function(e,t,n){Promise.resolve().then(n.bind(n,24299)),Promise.resolve().then(n.bind(n,1063))},1063:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(26705),l=n(20955),i=n(54440),a=n.n(i),s=n(59499),c=n(29401),o=n(49473),u=e=>{let{render:t,children:n,placement:i,toggle:a=!0,enterToToggle:u=!0,containerWidthMatchButton:d=!1,offsetValue:f=4,zIndex:m=1200,"data-test":p}=e,[v,x]=(0,l.useState)(!1),[h,g]=(0,l.useState)(null),{x:b,y:j,strategy:w,refs:N,context:C}=(0,s.YF)({open:v,onOpenChange:x,placement:null!=i?i:"bottom",whileElementsMounted:c.Me,middleware:[(0,o.cv)(f),(0,o.uY)(),(0,o.dp)({apply(e){let{rects:t,elements:n,availableHeight:r}=e;Object.assign(n.floating.style,{maxHeight:"".concat(r,"px"),overflowY:"auto",minWidth:"".concat(t.reference.width,"px"),width:d?"".concat(t.reference.width,"px"):"auto"})}})]}),y=(0,l.useRef)([]),k=(0,s.eS)(C,{event:"mousedown",keyboardHandlers:!1}),I=(0,s.bQ)(C),E=(0,s.qs)(C,{role:"listbox"}),R=(0,s.c0)(C,{listRef:y,activeIndex:h,onNavigate:g,loop:!0}),{getReferenceProps:O,getFloatingProps:S}=(0,s.NI)([k,I,E,R]);return(0,r.jsxs)(r.Fragment,{children:[(0,l.cloneElement)(n,O({ref:N.setReference,isOpen:v,onKeyDown(e){u&&"Enter"===e.key&&e.target instanceof HTMLInputElement&&x(!v)},...n.props})),v&&(0,r.jsx)(s.ll,{children:(0,r.jsx)(s.wD,{context:C,modal:!1,initialFocus:-1,children:(0,r.jsx)("div",{"data-test":p,className:"w-max bg-white shadow-md",...S({ref:N.setFloating,style:{position:w,top:null!=j?j:"",left:null!=b?b:"",zIndex:m}}),children:t({close:()=>x(!1),listRef:y,activeIndex:h})})})})]})},d=e=>{let{className:t,title:n,onCloseClick:l,isUserCreated:i}=e;return n&&0!==n.length?(0,r.jsxs)("div",{className:a()("flex items-center px-3 py-0.5 text-white bg-bf500  rounded-full",{"pr-2":l},{"!bg-white !border !border-gray-300 !text-gray-900":i},t),children:[(0,r.jsx)("span",{className:"py-0.5 text-sm",children:n}),l&&(0,r.jsx)("div",{className:"ml-1 rounded-full cursor-pointer",onClick:e=>{e.stopPropagation(),l()},children:(0,r.jsx)("div",{className:"fr-fi-close-line flex m-auto scale-75"})})]}):null};function f(e){return void 0!==e.title}let m=(e,t)=>{var n;return null===(n=t.find(t=>t.value===e))||void 0===n?void 0:n.label},p=e=>e.length>0?f(e[0])?e.reduce((e,t)=>f(t)?e.concat(t.options):e,[]):e:[],v=(e,t)=>e.reduce((e,n)=>{if(void 0!==n.value&&n.label.toLowerCase().includes(t.toLowerCase()))return[...e,n];if(f(n)){let r=n.options.filter(e=>e.label.toLowerCase().includes(t.toLowerCase()));if(r.length>0)return[...e,{title:n.title,options:r}]}return e},[]),x=e=>{let{isSelected:t}=e;return(0,r.jsx)("div",{className:"w-6 mr-2 shrink-0",children:t?(0,r.jsx)("span",{className:"block fr-fi-check-line scale-75"}):null})},h=e=>{let{isOpen:t}=e;return(0,r.jsx)("span",{className:a()("fr-fi-arrow-down-s-line mt-1 scale-90 ml-auto",{"rotate-180":t})})};var g=e=>{let{values:t,options:n,onSelect:l,renderOption:i,renderOptionMenu:a,noOptionPlaceholder:s,isLoading:c=!1,dataTest:o,listRef:u,activeIndex:d}=e;return(0,r.jsx)("div",{"data-test":"".concat(o,"-options"),children:c?(0,r.jsx)("div",{className:"p-4 text-sm text-gray-500",children:"Chargement..."}):n.length>0?n.map((e,n)=>f(e)?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"w-full p-1 pl-10 text-left text-sm italic text-gray-500 bg-gray-100 border-y border-gray-200",children:e.title}),e.options.map((e,n)=>(0,r.jsx)(b,{index:n,option:e,values:t,onSelect:l,renderOption:i,renderOptionMenu:a,listRef:u,activeIndex:d},"".concat(e.value)))]},e.title+n):(0,r.jsx)(b,{index:n,option:e,values:t,onSelect:l,renderOption:i,renderOptionMenu:a,listRef:u,activeIndex:d},e.value)):(0,r.jsx)("div",{className:"p-4 text-sm text-gray-500",children:s||"Aucune option disponible"})})};let b=e=>{let{index:t,values:n,option:l,onSelect:i,renderOption:s,renderOptionMenu:c,listRef:o,activeIndex:d}=e;return(0,r.jsxs)("button",{"data-test":l.value,ref:e=>{o&&(o.current[t]=e)},role:"option",tabIndex:0,"aria-selected":(null==n?void 0:n.includes(l.value))&&t===d,className:a()("!outline-0 focus:bg-[#f6f6f6]","flex items-center w-full p-2 text-left text-sm"),onClick:()=>{(null==n?void 0:n.includes(l.value))?i(n.filter(e=>e!==l.value)):i([...n||[],l.value])},children:[(0,r.jsx)(x,{isSelected:(null==n?void 0:n.includes(l.value))||!1}),(0,r.jsx)("div",{className:"mr-auto",children:s?s(l):(0,r.jsx)("span",{className:"leading-6",children:l.label})}),c&&c({option:l})&&(0,r.jsx)(u,{placement:"top",offsetValue:{mainAxis:8},render:e=>{let{close:t}=e;return(0,r.jsx)("div",{onClick:e=>e.stopPropagation(),children:c({option:l,close:t})})},children:(0,r.jsx)(j,{})})]})},j=(0,l.forwardRef)((e,t)=>{let{isOpen:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:"ml-6 mr-4 p-1 cursor-pointer hover:bg-indigo-100",onClick:e=>{e.stopPropagation()},children:(0,r.jsx)("div",{...l,children:"..."})})});var w=e=>{let{values:t,options:n,onSelect:i,renderOption:s,onInputChange:c,buttonClassName:o,dsfrButton:d,placement:f,placeholderText:m,noOptionPlaceholder:p,isLoading:x=!1,containerWidthMatchButton:h,disabled:b,debounce:j=!1,externalOptionsFiltering:w=!1,"data-test":C}=e,[y,k]=(0,l.useState)(x);(0,l.useEffect)(()=>k(x),[x]);let[I,E]=(0,l.useState)(""),R=function(e,t,n){var r=this,i=(0,l.useRef)(null),a=(0,l.useRef)(0),s=(0,l.useRef)(null),c=(0,l.useRef)([]),o=(0,l.useRef)(),u=(0,l.useRef)(),d=(0,l.useRef)(e),f=(0,l.useRef)(!0);(0,l.useEffect)(function(){d.current=e},[e]);var m=!t&&0!==t&&"undefined"!=typeof window;if("function"!=typeof e)throw TypeError("Expected a function");t=+t||0;var p=!!(n=n||{}).leading,v=!("trailing"in n)||!!n.trailing,x="maxWait"in n,h=x?Math.max(+n.maxWait||0,t):null;return(0,l.useEffect)(function(){return f.current=!0,function(){f.current=!1}},[]),(0,l.useMemo)(function(){var e=function(e){var t=c.current,n=o.current;return c.current=o.current=null,a.current=e,u.current=d.current.apply(n,t)},n=function(e,t){m&&cancelAnimationFrame(s.current),s.current=m?requestAnimationFrame(e):setTimeout(e,t)},l=function(e){if(!f.current)return!1;var n=e-i.current;return!i.current||n>=t||n<0||x&&e-a.current>=h},g=function(t){return s.current=null,v&&c.current?e(t):(c.current=o.current=null,u.current)},b=function e(){var r=Date.now();if(l(r))return g(r);if(f.current){var s=t-(r-i.current);n(e,x?Math.min(s,h-(r-a.current)):s)}},j=function(){var d=Date.now(),m=l(d);if(c.current=[].slice.call(arguments),o.current=r,i.current=d,m){if(!s.current&&f.current)return a.current=i.current,n(b,t),p?e(i.current):u.current;if(x)return n(b,t),e(i.current)}return s.current||n(b,t),u.current};return j.cancel=function(){s.current&&(m?cancelAnimationFrame(s.current):clearTimeout(s.current)),a.current=0,c.current=i.current=o.current=s.current=null},j.isPending=function(){return!!s.current},j.flush=function(){return s.current?g(Date.now()):u.current},j},[p,x,t,h,v,m])}(()=>{c&&c(I),k(!1)},500);return(0,l.useEffect)(()=>{j?R():c&&c(I)},[I,c,j,R]),(0,r.jsx)(u,{containerWidthMatchButton:h,placement:f,toggle:!1,enterToToggle:!1,render:e=>{let{listRef:l,activeIndex:a}=e;return(0,r.jsx)(g,{dataTest:C,listRef:l,activeIndex:a,values:t,options:w?n:v(n,I),onSelect:e=>{i(e),E("")},renderOption:s,noOptionPlaceholder:p,isLoading:y})},children:(0,r.jsx)(N,{"data-test":C,buttonClassName:a()(d&&"fr-select !flex !px-4 !bg-none !bg-grey975",o),options:n,values:t,inputValue:I,onInputChange:e=>{j&&k(!0),E(e)},onSelect:i,onChangeFocus:()=>k(!1),placeholderText:m,disabled:b})})};let N=(0,l.forwardRef)((e,t)=>{let{isOpen:n,values:i,options:s,buttonClassName:c,placeholderText:o,"data-test":u,inputValue:f,onInputChange:v,onSelect:x,onChangeFocus:g,disabled:b,...j}=e,w=(0,l.useRef)(null);return(0,l.useEffect)(()=>{n||v("")},[n,v]),(0,r.jsx)("div",{ref:t,"data-test":u,"aria-expanded":n,"aria-label":"ouvrir le menu",...j,children:(0,r.jsxs)("div",{className:a()("flex items-center w-full p-2 text-left text-sm",c),onClick:()=>{var e;null==w||null===(e=w.current)||void 0===e||e.focus()},children:[(0,r.jsxs)("div",{className:"flex items-center flex-wrap gap-2 grow",children:[i&&(null==i?void 0:i.length)!==0&&i.map(e=>(0,r.jsx)(d,{title:m(e,p(s)),onCloseClick:()=>x(i.filter(t=>t!==e))},e)),(0,r.jsx)("input",{type:"text",ref:w,className:"grow placeholder:text-grey425 outline-0",value:f,placeholder:o,onChange:e=>v(e.target.value),onFocus:()=>g(),onClick:()=>g(),disabled:b})]}),(0,r.jsx)(h,{isOpen:n})]})})});var C=n(24033),y=n(83402),k=n(49303);let I=e=>{let{filteredCollectivites:t,isCollectivitesLoading:n,setSearch:l}=e,i=(0,C.useRouter)();return(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(w,{dsfrButton:!0,containerWidthMatchButton:!0,buttonClassName:"!shadow-none !border-b-2 !border-[#000091]",values:[],options:t,onSelect:e=>{var n,r;let l=null!==(r=null===(n=t.find(t=>t.value===e[0]))||void 0===n?void 0:n.label)&&void 0!==r?r:"";i.push("/collectivite/".concat(e[0],"/").concat((0,k.LE)(l)))},onInputChange:e=>l(e),placeholderText:"Rechercher un EPCI, un syndicat, une commune, un PETR, un EPT",isLoading:n,debounce:!0,externalOptionsFiltering:!0})})};var E=()=>{var e,t;let[n,i]=(0,l.useState)(""),a=(0,y.$)(n);return(0,r.jsx)(I,{filteredCollectivites:null!==(t=null===(e=a.data)||void 0===e?void 0:e.filteredCollectivites.map(e=>({value:e.code_siren_insee,label:e.nom})))&&void 0!==t?t:[],isCollectivitesLoading:a.isLoading,setSearch:i})}},83402:function(e,t,n){"use strict";n.d(t,{$:function(){return i},G:function(){return a}});var r=n(80874),l=n(42333);let i=e=>(0,l.ZP)("site_labellisation-filtered-".concat(e),async()=>{let t=r.O.from("site_labellisation").select().order("nom").limit(10);if(e){let n=e.split(" ").map(e=>e.trim()).filter(e=>""!==e).join(" "),r=n.split(" ").join("-"),l=n.split(" ").join(" - "),i=n.split("-").join(" ");t.or('"nom".ilike.%'.concat(n,'%,"nom".ilike.%').concat(r,'%,"nom".ilike.%').concat(l,'%,"nom".ilike.%').concat(i,"%"))}let{error:n,data:l}=await t;if(n)throw Error("site_labellisation-filtered-".concat(e));return l&&l.length?{filteredCollectivites:l||[]}:null}),a=e=>(0,l.ZP)("site_labellisation-".concat(e),async()=>{let{data:t,error:n}=await r.O.from("site_labellisation").select().match({code_siren_insee:e});if(n)throw Error("site_labellisation-".concat(e));return t&&t.length?t:null})},80874:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var r=n(53248);let l=(0,r.eI)("https://rlarzronkgoyvtdkltqy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJsYXJ6cm9ua2dveXZ0ZGtsdHF5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2NDQ0MjM3NTcsImV4cCI6MTk1OTk5OTc1N30.Ciu6o-2Tnjm0yY7UuYcUeZNZbRGDOIQ4I6kA6hwkSuw",{db:{schema:"public"}})},49303:function(e,t,n){"use strict";n.d(t,{LE:function(){return r},GD:function(){return l}});let r=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9 ]/g,"").trim().toLowerCase().split(" ").filter(e=>e.length>0).join("-"),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e?e.toLocaleString(void 0,{maximumFractionDigits:t}):"0"}},24299:function(e,t,n){"use strict";n.r(t);var r=n(26705),l=n(54440),i=n.n(l),a=n(20955);t.default=e=>{let{slides:t,className:n,autoSlide:l=!1,autoSlideDelay:s=5e3}=e,[c,o]=(0,a.useState)(0),u=(0,a.useCallback)(e=>{let n=c+("next"===e?1:-1);n<0?o(t.length-1):n>=t.length?o(0):o(n)},[c,t.length]);return(0,a.useEffect)(()=>{let e;return l&&(e=setInterval(()=>{u("next")},s)),()=>clearInterval(e)},[c,l,s,u]),(0,r.jsxs)("div",{className:i()("flex justify-between items-center min-h-[250px]",n),children:[t.length>1&&(0,r.jsx)("button",{className:"fr-btn fr-icon-arrow-left-s-line rounded-md min-w-[40px]",title:"previous",onClick:()=>u("previous")}),(0,r.jsx)("div",{className:"overflow-hidden",children:(0,r.jsx)("div",{className:"whitespace-nowrap",style:{transition:"ease 1000ms",transform:"translate3d(".concat(-(100*c),"%, 0, 0)")},children:t.map((e,t)=>(0,r.jsx)("div",{className:"inline-block whitespace-normal w-full",children:(0,r.jsx)("div",{className:"flex justify-center",children:e})},t))})}),t.length>1&&(0,r.jsx)("button",{className:"fr-btn fr-icon-arrow-right-s-line rounded-md min-w-[40px]",title:"next",onClick:()=>u("next")})]})}},24033:function(e,t,n){e.exports=n(68165)}},function(e){e.O(0,[248,333,340,121,114,744],function(){return e(e.s=6656)}),_N_E=e.O()}]);